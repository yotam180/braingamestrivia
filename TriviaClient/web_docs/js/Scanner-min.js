function Scanner(m,n){var d=new WebSocket("ws://"+m+":"+n+"/"),c=[],g={},f={},e=null,h=null,k,l;d.onmessage=function(a){a=isNaN(a.data)?a.data:parseInt(a.data);console.log("Got packet: "+a);if(NaN==a)debugger;if(e){if(c.push(a),c.length>=h&&e){a=e;h=e=null;var b=c;c=[];a(b)}}else if(f[a])f[a](),delete f[a];else if(g[a])g[a]()};d.onopen=function(){k.hide();l.show()};d.onerror=function(){$(".full").hide();$("#failedConnectionDiv").show();d.close()};d.onclose=function(){$(".full").hide();$("#failedConnectionDiv").show()};
this.send=function(a){d.send(a.toString());return this};this.callback=function(a,b){f[a]=b;return this};this.handler=function(a,b){g[a]=b;return this};this.expect=function(a,b){if(c.length>=a)console.log("Queue is being executed synchronously"),b(c),c=[];else return h=a,e=b,this};this.loading=function(a){k=a;return this};this.ready=function(a){l=a;return this}};